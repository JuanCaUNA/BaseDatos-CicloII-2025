generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

// estados
enum EstadoPerfil {
    ACTIVO
    INACTIVO
}

enum EstadoRegistro {
    PENDIENTE
    APROBADO
    RECHAZADO
}

enum Nacionalidad {
    NACIONAL
    EXTRANJERO
}

enum TipoUsuario {
    MEDICO
    ADMINISTRATIVO
}

enum TipoCuenta {
    AHORROS
    CORRIENTE
}

model Permiso {
    id Int @id @default(autoincrement())

    pantalla    String  @unique
    lectura     Boolean @default(false)
    escritura   Boolean @default(false)
    eliminacion Boolean @default(false)

    // Relaciones
    Accesos   Accesos? @relation(fields: [accesosId], references: [id])
    accesosId Int?
}

model Accesos {
    id Int @id @default(autoincrement())

    tipoUsuariol TipoUsuario

    permisos Permiso[]
}

model DetalleDocumento {
    id Int @id @default(autoincrement())

    tipoUsuariol         TipoUsuario
    documentosRequeridos String
}

model Documento {
    id Int @id @default(autoincrement())

    url         String @unique
    descripcion String

    // Relaciones
    Perfil   Perfil? @relation(fields: [perfilId], references: [id])
    perfilId Int?
    Medico   Medico? @relation(fields: [medicoId], references: [id])
    medicoId Int?
}

model CuentaBancaria {
    id Int @id @default(autoincrement())

    banco      String
    numero     String     @unique
    titular    String
    tipoCuenta TipoCuenta

    esPrincipal Boolean

    // Relaciones
    Usuario   Usuario? @relation(fields: [usuarioId], references: [id])
    usuarioId Int?
}

model Preregistro {
    // Identificación
    id     Int    @id @default(autoincrement())
    cedula String @unique

    // Información usuariol
    nombre          String
    apellidos       String
    fechaNacimiento DateTime
    sexo            String
    estadoCivil     String
    nacionalidad    Nacionalidad
    residencia      String

    // Contacto
    email            String @unique
    telefono         String
    direccionCasa    String
    direccionTrabajo String

    // Estados
    estadoRegistro EstadoRegistro @default(PENDIENTE)
}

model Usuario {
    // Identificación
    id     Int    @id @default(autoincrement())
    cedula String @unique

    // Información usuariol
    nombre          String
    apellidos       String
    fechaNacimiento DateTime
    sexo            String
    estadoCivil     String
    nacionalidad    Nacionalidad

    // Informacion de cuentas bancarias
    cuentaBancarias CuentaBancaria[]

    // Contacto
    email            String @unique
    telefono         String
    residencia       String
    direccionCasa    String
    direccionTrabajo String

    // Relaciones
    // perfils Perfil[]
    Medico Medico[]
}

model Perfil {
    // Identificación
    id Int @id @default(autoincrement())

    documentosRequeridos Documento[]

    // Estado y tipo
    estado      EstadoPerfil @default(ACTIVO)
    tipoUsuario TipoUsuario

    // Relaciones
    // usuario   Usuario @relation(fields: [usuarioId], references: [id])
    // usuarioId Int
}

model Medico {
    // Identificación
    id Int @id @default(autoincrement())

    documentosRequeridos Documento[]

    // Estado y tipo
    estado      EstadoPerfil @default(ACTIVO)
    tipoUsuario TipoUsuario

    // Relaciones
    usuario   Usuario @relation(fields: [usuarioId], references: [id])
    usuarioId Int
}
