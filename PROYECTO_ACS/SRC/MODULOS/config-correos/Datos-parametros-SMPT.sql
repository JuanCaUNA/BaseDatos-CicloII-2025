-- !DATOS TABLA ACS_PARAMETROS-- ** Seccion: Preconfiguraci√≥n de parametros en la tabla ACS_PARAMETROS **
/*
CREATE TABLE ACS_PARAMETROS (
    APA_ID      NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    APA_NOMBRE_PARAMETRO   VARCHAR2(100) UNIQUE NOT NULL,
    APA_VALOR_PARAMETRO   VARCHAR2(4000),
    APA_DESCRIPCION       VARCHAR2(200),
    APA_TIPO_PARAMETRO    VARCHAR2(20) DEFAULT 'SISTEMA',  -- Opcional: SISTEMA, EMAIL, SMTP, OTRO
);
*/
-- !DATOS TABLA ACS_PARAMETROS

MERGE INTO ACS_PARAMETROS t
USING (
    -- Parametro global
    SELECT 'CORREO_DBA' APA_NOMBRE_PARAMETRO, 'juancarlos19defebrerohat@gmail.com' APA_VALOR_PARAMETRO, 'Correo del DBA' APA_DESCRIPCION, 'CORREO_DBA' APA_TIPO_PARAMETRO FROM DUAL UNION ALL
    -- Configuracion SMTP
    SELECT 'SMTP_HOST', 'smtp-relay.brevo.com', 'Servidor para envio de correos', 'SMTP' FROM DUAL UNION ALL
    SELECT 'SMTP_PORT', '587', 'Puerto del servidor SMTP', 'SMTP' FROM DUAL UNION ALL
    SELECT 'SMP_ACL_FILe', 'brevo_acl.xml', 'archivo acl', 'SMTP' FROM DUAL
    -- Datos Servidor SMTP
    SELECT 'SMTP_CORREO', 'a1e38001@smtp-brevo.com', 'Correo para notificaciones automaticas', 'SMTP' FROM DUAL UNION ALL
    SELECT 'SMTP_USUARIO', 'a1e38001@smtp-brevo.com', 'Usuario del servidor', 'SMTP' FROM DUAL UNION ALL
) s
ON (t.APA_NOMBRE_PARAMETRO = s.APA_NOMBRE_PARAMETRO)
WHEN MATCHED THEN
    UPDATE SET
        t.APA_VALOR_PARAMETRO = s.APA_VALOR_PARAMETRO,
        t.APA_DESCRIPCION = s.APA_DESCRIPCION,
        t.APA_TIPO_PARAMETRO = s.APA_TIPO_PARAMETRO
WHEN NOT MATCHED THEN
    INSERT (APA_NOMBRE_PARAMETRO, APA_VALOR_PARAMETRO, APA_DESCRIPCION, APA_TIPO_PARAMETRO)
    VALUES (s.APA_NOMBRE_PARAMETRO, s.APA_VALOR_PARAMETRO, s.APA_DESCRIPCION, s.APA_TIPO_PARAMETRO);
COMMIT;
/

/*
CREATE TABLE ACS_CLAVE (
    ACL_ID       NUMBER GENERATED BY DEFAULT AS IDENTITY,
    ACL_NOMBRE_CLAVE VARCHAR2(50) UNIQUE NOT NULL,
    ACL_TIPO     VARCHAR2(20) NOT NULL, -- Correo SMTP, OTRO
    ACL_CLAVE    RAW(400) NOT NULL
);
*/
-- clave usuario servidor SMTP
ACS_PRC_GUARDAR_CLAVE('SMTP_CLAVE', 'SMTP', 'bskiTLMr8wV26Rp')
/